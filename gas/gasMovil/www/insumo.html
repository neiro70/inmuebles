<!DOCTYPE html>
<html>

<head>
  <meta http-equiv='cache-control' content='no-cache'>
  <meta http-equiv='expires' content='0'>
  <meta http-equiv='pragma' content='no-cache'>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="themes/gas-rojo.min.css">
  <link rel="stylesheet" href="themes/jquery.mobile.icons.min.css" />
  <link rel="stylesheet" href="themes/jquery.mobile.structure-1.4.5.min.css" />
  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/jquery.mobile-1.4.5.min.js"></script>

</head>

<body>

  <div data-role="page" id="pageone">
    <div data-role="panel" id="mypanel">

      <!-- panel content goes here -->


      <ul data-role="listview" data-inset="false">
        <li data-icon="edit"><a id="linkregistrar" href="javascript:window.location.href = 'insumo.html'">Registrar</a>
          </li>
        <li data-icon="calendar"><a id="linkAgendar" href="javascript:window.location.href = 'agendar.html'">Agendar</a>
        </li>
        <li data-icon="star"><a id="linkReporte" href="javascript:window.location.href = 'reporte.html'">Reportes</a>
        </li>
        <li data-icon="grid"><a id="linkDasboard" href="javascript:window.location.href = 'dashboard.html'">Dasboard</a></li>
        <li data-icon="power"><a id="linkCerrar" href="javascript:window.location.href = 'login.html'">Cerrar</a></li>
      </ul>


    </div><!-- /panel -->


    <div data-role="header">
      <a href="#mypanel" id="cambiaVentana"
        class="ui-btn ui-shadow ui-corner-all ui-btn-inline ui-btn-icon-left ui-icon-bars ui-btn-icon-notext "></a>
      <h1>Regitrar Pedido</h1>

    </div>

    <div data-role="main" class="ui-content">

      <form id="forma">

        <label for="cdireccion"><img src="img/home.svg" width="36" height="36" style="margin-bottom: -10px;" > Direcci&oacute;n</label>
        <input type="text" data-clear-btn="true" name="cdireccion" id="cdireccion" value="">
        <label for="cnombre">Nombre:</label>
        <input type="text" data-clear-btn="true" name="cnombre" id="cnombre" value="">
        <label for="capaterno">Apellido Paterno:</label>
        <input type="text" data-clear-btn="true" name="capaterno" id="capaterno" value="">
        <label for="camaterno">Apellido Materno:</label>
        <input type="text" data-clear-btn="true" name="camaterno" id="camaterno" value="">
        <label for="crfc">RFC:</label>
        <input type="text" data-clear-btn="true" name="crfc" id="crfc" value="">
        <label for="ctelefono"><img src="img/telefono.svg" width="36" height="36" style="margin-bottom: -10px;" > Telefono</label>
        <input type="number" data-clear-btn="true" name="ctelefono" id="ctelefono" value="">
       <label for="cprecioxlitro"><img src="img/dinero.svg" width="36" height="36" style="margin-bottom: -10px;" > Precio por litro</label>
        <input type="number" data-clear-btn="true" name="cprecioxlitro" id="cprecioxlitro" value="">
        <label for="clitros"><img src="img/tacometro3.png" width="36" height="36" style="margin-bottom: -10px;" > Litros</label>
        <input type="range" name="clitros" id="clitros" value="60" min="0" max="1000" data-highlight="true">
		<label for="cimporte">Importe:</label>
        <input type="number" data-clear-btn="true" name="cimporte" id="cimporte" value="">
        <label for="cmonto"><img src="img/dinero.svg" width="36" height="36" style="margin-bottom: -10px;" > Monto</label>
        <input type="number" data-clear-btn="true" name="cmonto" id="cmonto" value="">
        <label for="cpago"><img src="img/tarjeta.svg" width="36" height="36" style="margin-bottom: -10px;" > Pago</label>
        
		<select name="cpago" id="cpago">
          <option value="1">Efectivo</option>
		  <option value="2">Crédito</option>
		  <option value="3">Combinado</option>
          <option value="4">TPV Santander</option>
          <option value="5">TPV Amex </option>
          <option value="6">BBVA</option>
          <option value="7">BNMX</option>
          <option value="8">Gasomatic</option>
	       		  
        </select>
		<div id="divMontoCombinado">
		<label for="cmontoefectivo">Monto en Efectivo:</label>
        <input type="number" data-clear-btn="true" name="cmontoefectivo" id="cmontoefectivo" value="">
		<label for="cmontotarjeta">Monto con Tarjeta:</label>
        <input type="number" data-clear-btn="true" name="cmontotarjeta" id="cmontotarjeta" value="">
		<label for="cmontocredito">Monto en Crédito:</label>
        <input type="number" data-clear-btn="true" name="cmontocredito" id="cmontocredito" value="">
		</div>
		
		<div id="divfechaPago">
        <label class="hidden" for="cfechapago"> Fecha de Pago:</label>
        <input type="date" name="cfechapago" id="cfechapago" value="">
		</div>
		
        <label for="cfecha"> Proximo Suministro:</label>
        <input type="date" name="cfecha" id="cfecha" value="">
        <label for="cobeservaciones"><img src="img/lapiz.svg" width="36" height="36" style="margin-bottom: -10px;" > Observaciones</label>
        <textarea name="cobeservaciones" id="cobeservaciones">
        </textarea>
        <input type="hidden" name="idUsuario" id="idUsuario">
      </form>
      <br>
      <a href="#" onclick="guardar()" 
              class="ui-btn  ui-shadow ui-corner-all" id="guardar"
              name="guardar">
              <img src="img/save.png" width="26" height="26" >
                <br>
              Guardar</a>
      <!-- >div class="ui-grid-a">
        <div class="ui-block-a">
          <div class="ui-bar ui-bar-a" style="height:60px"><a href="#" onclick="sicronizar()"
              class="ui-btn ui-icon-recycle ui-btn-icon-left ui-shadow ui-corner-all" id="sicronizar"
              name="sicronizar">Sicronizar</a></div>
        </div>
        <div class="ui-block-b">
          <div class="ui-bar ui-bar-a" style="height:60px"><a href="#" onclick="guardar()"
              class="ui-btn ui-icon-check ui-btn-icon-left ui-shadow ui-corner-all" id="guardar"
              name="guardar">Guardar</a></div>
        </div>

      </div-->

    </div>

    <div data-role="footer">
      <h1>OperaGAS</h1>
    </div>
  </div>

  <!-- dialog #page2  -->
  <div id="dialog" data-role="page">
    <div data-role="header">
      <h1>Transacci&oacute;n</h1>
    </div>
    <div data-role="content" id="msg">
      Se han guardado los datos
    </div>
  </div>
  
  <script type="text/javascript">
  
	var ajustarLitros=true
	var ajustarPesos=true
    $("#cambiaVentana").click(function () {
      $("#linkBuscar").attr("href", "lista.html?r=" + Math.random());
    });
	

    $(document).ready(function () {
      console.log("ready!");
     $("#idUsuario").val(localStorage.getItem('idUsuario'));
     cargaFormaPago();
      $("#linkBuscar").attr("href", "lista.html?r=" + Math.random());
	  $("#divMontoCombinado").hide("slow");
	  $("#divfechaPago").hide("slow");
	  
	  $("#cpago").change(function() {
	  
		if ($("#cpago").val() === '3'){
		
		 $("#divMontoCombinado").show("slow");
		}else {
			$("#divMontoCombinado").hide("slow");
		}
		
		if ($("#cpago").val() === '2'){
		 $("#divfechaPago").show("slow");
		}else {
			$("#divfechaPago").hide("slow");
		}
		
		});
		
		
     $("#clitros").change(function() {
			var litros=$("#clitros").val();
			var precioxlitro=$("#cprecioxlitro").val(); 
			if ( isNaN( precioxlitro )){
				precioxlitro=0;
			}
			console.log("litros " + litros) 
			var suma = litros * precioxlitro;
			if(ajustarPesos === true){
				$("#cimporte").val(suma);
				$("#cmonto").val(suma);
				ajustarLitros = false
			}else{
				ajustarPesos = true
			}
			
		   
		});
		
		$("#cimporte").change(function() {
			var pesos=$("#cimporte").val();
			var precioxlitro=$("#cprecioxlitro").val(); 
			if ( isNaN( precioxlitro )){
				precioxlitro=0;
			}
			console.log("pesos " + pesos);
			var litros = pesos / precioxlitro;
			if(ajustarLitros === true){
				$("#clitros").val(litros);
				$("#cmonto").val(pesos);
				ajustarPesos = false;
			}else{
				ajustarLitros = true;
			}
		});

    $("#sicronizar").click(function () {
      var forma = $("#forma").serialize();
      //console.info("forma:", forma);
      $("#msg").html(forma);


      $.mobile.changePage("#dialog", {
        role: "dialog"  // show #page2 as dialog
      })

    });
	
	 });
    function guardar() {
     
    console.info("forma:", $("#forma").serialize());
   
      showLoading();
      $.ajax({
        url: "http://dratl.com.mx/inmuebles/gas/gasWeb/mvc/view/gas/ejemplo.php",
        method: "POST",
        data: $("#forma").serialize(), success: function (result) {
          //console.info("result:",result);
          var obj = $.parseJSON(result);
          $("#msg").html("Se registro suministro " + obj.exito);

          $.mobile.changePage("#dialog", {
            role: "dialog"  // show #page2 as dialog
          });

        }
      });

      return false;
    }
    function sicronizar() {
      var forma = $("#forma").serialize();
      //console.info("forma:", forma);
      $("#msg").html(forma);
      $.mobile.changePage("#dialog", {
        role: "dialog"  // show #page2 as dialog
      })

    }
    /***************** funciones loading ***********************/
    function hideLoading() {

      $.mobile.loading('hide', {
        text: 'Cargando',
        textVisible: true,
        theme: 'z',
        html: ""
      });
    }
    function showLoading() {

      $.mobile.loading('show', {
        text: 'Cargando',
        textVisible: true,
        theme: 'z',
        html: ""
      });
    }
/***********************************************************/


function cargaFormaPago(){
  $("#cpago").empty();
  showLoading();
        $.ajax({
          url: "http://dratl.com.mx/inmuebles/gas/gasWeb/mvc/view/gas/consultaFormaPago.php",
              method: "get",
              headers : {
                  'Cache-Control': 'no-transform'
              },
              success: function (result) {
               
                var data = $.parseJSON(result);

                $.each(data, function(i, obj) {
                 // console.info("obj:",obj);
                  $("#cpago").append('<option value='+obj.idc02pago+'>'+obj.descripcion+'</option>');
                });

              },complete:function(){
                hideLoading();
              }
            });
 }

  </script>
</body>


</html>